# Auto-generated by oag â€” do not edit
import pytest
from httpx import AsyncClient
{% if model_imports %}
from .models import {{ model_imports | join(", ") }}
{% endif %}
{% for op in operations %}


@pytest.mark.asyncio
async def test_{{ op.name }}_route_exists(client: AsyncClient):
    """Route {{ op.http_method|upper }} {{ op.path }} is registered (not 404)."""
{% if op.has_body %}
    response = await client.{{ op.http_method }}("{{ op.test_path }}", json={})
{% else %}
    response = await client.{{ op.http_method }}("{{ op.test_path }}")
{% endif %}
    assert response.status_code != 404
{% if op.kind == "standard" or op.kind == "void" %}


@pytest.mark.asyncio
async def test_{{ op.name }}_not_implemented(client: AsyncClient):
    """Stub raises NotImplementedError (500)."""
{% if op.has_body %}
    response = await client.{{ op.http_method }}("{{ op.test_path }}", json={{ op.mock_body }})
{% else %}
    response = await client.{{ op.http_method }}("{{ op.test_path }}")
{% endif %}
    assert response.status_code == 500
{% endif %}
{% if op.has_body %}


@pytest.mark.asyncio
async def test_{{ op.name }}_validates_input(client: AsyncClient):
    """Invalid body returns 422."""
    response = await client.{{ op.http_method }}("{{ op.test_path }}", content=b"not json", headers={"content-type": "application/json"})
    assert response.status_code == 422
{% endif %}
{% endfor %}


@pytest.mark.asyncio
async def test_invalid_path_returns_404(client: AsyncClient):
    """Unknown path returns 404."""
    response = await client.get("/does-not-exist")
    assert response.status_code == 404
